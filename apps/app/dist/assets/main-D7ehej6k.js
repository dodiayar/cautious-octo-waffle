(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const v of s.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&n(v)}).observe(document,{childList:!0,subtree:!0});function o(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=o(i);fetch(i.href,s)}})();let r=[],d=[],u=[],c="date",p=!1,a={task:"",project:"",organization:"",dueDate:""},m=null;document.addEventListener("DOMContentLoaded",async()=>{console.log("Dev Tasks app initialized"),await T(),I(),f(),typeof PluginMessageHandler>"u"&&window.addEventListener("keydown",e=>{e.code==="Space"&&(e.preventDefault(),window.dispatchEvent(new CustomEvent("sideClick")))})});async function g(){const e={tasks:r,projects:d,organizations:u,currentSortMode:c};if(window.creationStorage)try{const t=btoa(JSON.stringify(e));await window.creationStorage.plain.setItem("dev_tasks_data",t),console.log("Data saved")}catch(t){console.error("Error saving data:",t)}else localStorage.setItem("dev_tasks_data",JSON.stringify(e))}async function T(){let e=null;if(window.creationStorage)try{const t=await window.creationStorage.plain.getItem("dev_tasks_data");t&&(e=JSON.parse(atob(t)))}catch(t){console.error("Error loading data:",t)}else{const t=localStorage.getItem("dev_tasks_data");t&&(e=JSON.parse(t))}e&&(r=e.tasks||[],d=e.projects||[],u=e.organizations||[],c=e.currentSortMode||"date")}function I(){document.getElementById("addBtn").addEventListener("click",S),document.getElementById("sortBtn").addEventListener("click",P),document.getElementById("cancelAddBtn").addEventListener("click",B),document.getElementById("confirmTaskBtn").addEventListener("click",x),document.getElementById("cancelEditBtn").addEventListener("click",L),document.getElementById("saveEditBtn").addEventListener("click",z),document.getElementById("deleteTaskBtn").addEventListener("click",M),window.addEventListener("sideClick",h)}function l(e){document.querySelectorAll(".view").forEach(t=>{t.classList.remove("active")}),document.getElementById(e).classList.add("active")}function S(){D(),l("addView"),k()}function B(){D(),l("mainView")}function L(){m=null,l("mainView")}function h(){document.querySelector(".view.active").id==="addView"&&(p?C():j())}function j(){p=!0;const e=document.getElementById("voiceStatus"),t=document.getElementById("voiceText");if(e.classList.add("listening"),t.textContent="Listening... Describe your task",typeof PluginMessageHandler<"u"){const o=`Extract task information from the user's voice input. They will describe a software development task.
        
Extract these fields:
- task: The task description
- project: Project name (if mentioned)
- organization: Organization name (if mentioned)
- dueDate: Due date in YYYY-MM-DD format (if mentioned, interpret relative dates like "tomorrow", "next week", "in 3 days")

Current date: ${new Date().toISOString().split("T")[0]}

Respond ONLY with valid JSON in this exact format:
{"task":"description","project":"name or empty","organization":"name or empty","dueDate":"YYYY-MM-DD or empty"}

Now listen for the user's task description.`;PluginMessageHandler.postMessage(JSON.stringify({message:o,useLLM:!0,wantsR1Response:!1}))}else setTimeout(()=>{O()},2e3)}function C(){p=!1;const e=document.getElementById("voiceStatus"),t=document.getElementById("voiceText");e.classList.remove("listening"),t.textContent="Recording stopped. Press side button to speak again",setTimeout(()=>{t.textContent="Press side button to speak"},2e3)}function O(){const e={task:"Implement user authentication",project:"WebApp",organization:"TechCorp",dueDate:new Date(Date.now()+6048e5).toISOString().split("T")[0]};y(e)}function y(e){p=!1;const t=document.getElementById("voiceStatus"),o=document.getElementById("voiceText");t.classList.remove("listening"),o.textContent="Task captured!",e.task&&(a.task=e.task),e.project&&(a.project=e.project),e.organization&&(a.organization=e.organization),e.dueDate&&(a.dueDate=e.dueDate),k();const n=document.getElementById("confirmTaskBtn");n.disabled=!a.task,setTimeout(()=>{o.textContent="Press side button to speak again"},2e3)}window.onPluginMessage=function(e){if(console.log("Received message:",e),p){let t=null;if(e.data)try{t=typeof e.data=="string"?JSON.parse(e.data):e.data}catch{console.log("Could not parse data.data as JSON")}if(!t&&e.message)try{t=JSON.parse(e.message)}catch{console.log("Could not parse data.message as JSON")}t&&t.task&&y(t)}};function D(){a={task:"",project:"",organization:"",dueDate:""};const e=document.getElementById("voiceText");e.textContent="Press side button to speak",document.getElementById("voiceStatus").classList.remove("listening");const o=document.getElementById("confirmTaskBtn");o.disabled=!0}function k(){document.getElementById("previewTask").textContent=a.task||"‚Äî",document.getElementById("previewProject").textContent=a.project||"‚Äî",document.getElementById("previewOrg").textContent=a.organization||"‚Äî",document.getElementById("previewDue").textContent=a.dueDate?E(a.dueDate):"‚Äî"}function x(){if(!a.task)return;a.project&&!d.includes(a.project)&&d.push(a.project),a.organization&&!u.includes(a.organization)&&u.push(a.organization);const e={id:Date.now(),task:a.task,project:a.project,organization:a.organization,dueDate:a.dueDate,completed:!1,createdAt:new Date().toISOString()};r.push(e),g(),f(),l("mainView")}function z(){if(!m)return;const e=r.find(s=>s.id===m);if(!e)return;const t=document.getElementById("editTaskInput").value.trim();let o=document.getElementById("editProjectSelect").value,n=document.getElementById("editOrgSelect").value;const i=document.getElementById("editDueInput").value;if(!t){alert("Task description is required");return}o==="__new__"&&(o=prompt("Enter new project name:"),o&&!d.includes(o)&&d.push(o)),n==="__new__"&&(n=prompt("Enter new organization name:"),n&&!u.includes(n)&&u.push(n)),e.task=t,e.project=o||"",e.organization=n||"",e.dueDate=i,g(),f(),l("mainView")}function M(){m&&confirm("Delete this task?")&&(r=r.filter(e=>e.id!==m),g(),f(),l("mainView"))}function P(){c=c==="date"?"project":"date";const e=document.getElementById("sortBtn");e.textContent=c==="date"?"üìÖ":"üìÅ",g(),f()}function V(){return c==="date"?[...r].sort((e,t)=>!e.dueDate&&!t.dueDate?t.createdAt.localeCompare(e.createdAt):e.dueDate?t.dueDate?e.dueDate.localeCompare(t.dueDate):-1:1):[...r].sort((e,t)=>e.project!==t.project?e.project?t.project?e.project.localeCompare(t.project):-1:1:!e.dueDate&&!t.dueDate?t.createdAt.localeCompare(e.createdAt):e.dueDate?t.dueDate?e.dueDate.localeCompare(t.dueDate):-1:1)}function f(){const e=document.getElementById("taskList"),t=document.getElementById("emptyState");if(r.length===0){e.innerHTML="",t.classList.add("visible");return}t.classList.remove("visible");const o=V();e.innerHTML=o.map(n=>{const i=n.dueDate&&new Date(n.dueDate)<new Date&&!n.completed;return`
            <div class="task-item ${n.completed?"completed":""}" 
                 onclick="showEditView(${n.id})"
                 data-task-id="${n.id}">
                <div class="task-title">${w(n.task)}</div>
                <div class="task-meta">
                    ${n.project?`<span class="task-tag project">üìÅ ${w(n.project)}</span>`:""}
                    ${n.organization?`<span class="task-tag org">üè¢ ${w(n.organization)}</span>`:""}
                    ${n.dueDate?`<span class="task-tag due ${i?"overdue":""}">üìÖ ${E(n.dueDate)}</span>`:""}
                </div>
            </div>
        `}).join("")}function E(e){if(!e)return"";const t=new Date(e),o=new Date,n=new Date(o);if(n.setDate(n.getDate()+1),o.setHours(0,0,0,0),n.setHours(0,0,0,0),t.setHours(0,0,0,0),t.getTime()===o.getTime())return"Today";if(t.getTime()===n.getTime())return"Tomorrow";const i={month:"short",day:"numeric"};return t.getFullYear()!==o.getFullYear()&&(i.year="numeric"),t.toLocaleDateString("en-US",i)}function w(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}console.log("Dev Tasks app ready!");
